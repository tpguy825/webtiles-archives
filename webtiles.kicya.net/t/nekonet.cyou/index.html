<!DOCTYPE html>
<html lang="ja">
<head>
    <style>html, .tile-body {
  background-color: #000;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

#crt-container {
  background-image: url("/t/nekonet.cyou/misc2.jpg");
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
  width: 100%;
  height: 100%;
  position: relative;
}

#noise-canvas {
  pointer-events: none;
  opacity: .15;
  z-index: 10;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}

.scanlines {
  pointer-events: none;
  z-index: 20;
  background: linear-gradient(#fff0, #fff0 50%, #0003 50%, #0003) 0 0 / 100% 4px;
  width: 100%;
  height: 100%;
  animation: 10s linear infinite scrollScanlines;
  position: absolute;
  top: 0;
  left: 0;
}

.vignette {
  pointer-events: none;
  z-index: 30;
  background: radial-gradient(circle, #0000 60%, #0006 100%);
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  box-shadow: inset 0 0 150px #000000e6;
}

@keyframes scrollScanlines {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 0 100%;
  }
}
</style>
</head>
<body>
    <div id="crt-container">
        <canvas id="noise-canvas"></canvas>
        <div class="scanlines"></div>
        <div class="vignette"></div>
    </div>
    <script type="text/tilescript">document.addEventListener('DOMContentLoaded', function() {
    var canvas = document.getElementById('noise-canvas');
    var ctx = canvas.getContext('2d');

    var resizeCanvas = function() {
        var scaleFactor = 0.25; 
        canvas.width = Math.ceil(window.innerWidth * scaleFactor);
        canvas.height = Math.ceil(window.innerHeight * scaleFactor);
    };

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    var drawNoise = function() {
        var w = canvas.width;
        var h = canvas.height;
        var idata = ctx.createImageData(w, h);
        var buffer32 = new Uint32Array(idata.data.buffer);
        var len = buffer32.length;

        for (var i = 0; i < len; i++) {
            if (Math.random() < 0.5) {
                var val = Math.random() * 255;
                buffer32[i] = (255 << 24) | (val << 16) | (val << 8) | val;
            } else {
                buffer32[i] = 0;
            }
        }

        ctx.putImageData(idata, 0, 0);
        requestAnimationFrame(drawNoise);
    };

    var smallCanvas = false;
    
    var noiseLoop = function() {
        var w = canvas.width;
        var h = canvas.height;
        
        var idata = ctx.createImageData(w, h);
        var buffer32 = new Uint32Array(idata.data.buffer);
        var len = buffer32.length;
        
        for (var i = 0; i < len; i++) {
            var gray = (Math.random() * 255) | 0;
            buffer32[i] = (255 << 24) | (gray << 16) | (gray << 8) | gray;
        }
        ctx.putImageData(idata, 0, 0);
        
        requestAnimationFrame(noiseLoop);
    };

    requestAnimationFrame(noiseLoop);
});
</script>
</body>
</html>
