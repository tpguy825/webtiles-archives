<!doctype html>
<html lang="en">
	<head>
		<style>#container {
  grid-template-rows: repeat(14, 1fr);
  grid-template-columns: repeat(14, 1fr);
  width: 100%;
  height: 100%;
  display: grid;
  position: fixed;
  top: 0;
  left: 0;
}

.cell {
  background-color: #fff;
  width: 100%;
  height: 100%;
}

#thumb {
  z-index: 10;
  width: 100%;
  height: 100%;
  position: fixed;
  top: 0;
  left: 0;
}
</style>
	</head>
	<body>
        <img src="thumb.webp" id="thumb">
		<div id="container"></div>
		<script type="text/tilescript">document.getElementById('thumb').remove();

var container = document.getElementById('container');

var size = 14;

var cells = [];
var grid = [];

// init
for (var i = 0; i < size; i++) {
	grid[i] = [];
	cells[i] = [];
	for (var j = 0; j < size; j++) {
		var cell = document.createElement('div');
		cell.className = 'cell';
		container.appendChild(cell);

		cells[i][j] = cell;

		// random start
		grid[i][j] = Math.random() > 0.5;
		color(i, j, grid[i][j]);

		// drawing
		(function (i, j) {
			cell.addEventListener('pointermove', function () {
				grid[i][j] = true;
				color(i, j, true);
			});
		})(i, j);
	}
}

function color(i, j, v) {
	cells[i][j].style.backgroundColor = v ? 'black' : 'white';
}

function count_neighbors(i, j) {
	var neighbors = 0;

	for (var di = -1; di <= 1; di++) {
		for (var dj = -1; dj <= 1; dj++) {
			if (di === 0 && dj === 0) continue;

			var ni = i + di;
			var nj = j + dj;

			if (ni >= 0 && ni < size && nj >= 0 && nj < size) {
				neighbors += grid[ni][nj];
			}
		}
	}

	return neighbors;
}

function update() {
	var new_grid = [];
	for (var i = 0; i < size; i++) {
		new_grid[i] = [];
		for (var j = 0; j < size; j++) {
			var live_neighbors = count_neighbors(i, j);

			// rules
			if (grid[i][j]) {
				new_grid[i][j] = live_neighbors === 2 || live_neighbors === 3;
			} else {
				new_grid[i][j] = live_neighbors === 3;
			}

			color(i, j, new_grid[i][j]);
		}
	}
	grid = new_grid;
}

setInterval(update, 500);
</script>
	</body>
</html>
